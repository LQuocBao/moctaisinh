<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="author" content="Untree.co">
  <link rel="shortcut icon" href="favicon.png">

  <meta name="description" content="Khám phá bộ sưu tập sản phẩm thủ công độc bản từ vật liệu tái chế của Mộc Tái Sinh.">
  <meta name="keywords" content="sản phẩm mộc tái sinh, đồ gỗ tái chế, thủ công, sống xanh">

		<!-- Bootstrap CSS -->
		<link href="css/bootstrap.min.css" rel="stylesheet">
		<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
		<link href="css/tiny-slider.css" rel="stylesheet">
		<link href="css/style.css" rel="stylesheet">
		<title>Sản phẩm | Mộc Tái Sinh</title>
	</head>

	<body>

		<!-- Start Header/Navigation -->
		<nav class="custom-navbar navbar navbar navbar-expand-lg navbar-dark bg-dark" arial-label="Furni navigation bar" style="background: transparent !important; position: absolute; width: 100%; z-index: 10;">

			<div class="container">
				<a class="navbar-brand" href="index.html">moctaisinh<span>.</span>vn</a>

				<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarsFurni" aria-controls="navbarsFurni" aria-expanded="false" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon"></span>
				</button>

				<div class="collapse navbar-collapse" id="navbarsFurni">
					<ul class="custom-navbar-nav navbar-nav ms-auto mb-2 mb-md-0">
						<li class="nav-item">
							<a class="nav-link" href="index.html">Trang chủ</a>
						</li>
						<li class="active"><a class="nav-link" href="shop.html">Sản phẩm</a></li>
						<li><a class="nav-link" href="about.html">Về chúng tôi</a></li>
						<li><a class="nav-link" href="services.html">Dịch vụ</a></li>
						<li><a class="nav-link" href="blog.html">Blog</a></li>
						<li><a class="nav-link" href="contact.html">Kết nối với chúng tôi</a></li>
					</ul>

					<ul class="custom-navbar-cta navbar-nav mb-2 mb-md-0 ms-5">
						<li><a class="nav-link" href="cart.html"><img src="images/cart.svg"></a></li>
					</ul>
				</div>
			</div>
				
		</nav>
		<!-- End Header/Navigation -->

		<!-- Start Hero Section -->
			<div class="hero" style="background: url('../images/hero-bg.jpg') center center/cover no-repeat; position: relative; min-height: 320px; padding: 64px 0 32px 0; display: flex; align-items: center;">
				<div style="position: absolute; inset: 0; background: rgba(59,93,80,0.7); z-index: 1;"></div>
				<div class="container" style="position: relative; z-index: 2;">
					<div class="row justify-content-between">
						<div class="col-lg-12">
							<div class="intro-excerpt">
								<h1>Khám phá bộ sưu tập</h1>
								<p class="mb-4">Khám phá các sản phẩm độc bản, mỗi món đồ là một câu chuyện mộc tái sinh, một phần ký ức, một nguồn cảm hứng sống xanh.<br></p>
							</div>
						</div>
					</div>
				</div>
			</div>
		<!-- End Hero Section -->

		<!-- Start Product Filter & Sort Section -->
		<div class="shop-filters d-flex flex-wrap justify-content-center align-items-end gap-4 py-3 px-2 rounded-4 shadow-sm bg-white bg-opacity-75" style="max-width: 900px; margin: 0 auto 32px auto;">
			<div class="filter-group text-center" style="min-width:180px;">
				<label for="filter-material" class="form-label mb-2 fw-semibold" style="display:block;">Chất liệu</label>
				<select id="filter-material" class="form-select rounded-pill px-4">
					<option>Tất cả</option>
					<option>Gỗ tái chế</option>
					<option>Tre cũ</option>
					<option>Vật liệu tự nhiên</option>
				</select>
			</div>
			<div class="filter-group text-center" style="min-width:180px;">
				<label for="filter-style" class="form-label mb-2 fw-semibold" style="display:block;">Cảm hứng</label>
				<select id="filter-style" class="form-select rounded-pill px-4">
					<option>Tất cả</option>
					<option>Mộc mạc</option>
					<option>Cảm xúc</option>
					<option>Độc bản</option>
				</select>
			</div>
			<div class="filter-group text-center" style="min-width:180px;">
				<label for="sort-product" class="form-label mb-2 fw-semibold" style="display:block;">Sắp xếp</label>
				<select id="sort-product" class="form-select rounded-pill px-4">
					<option>Mới nhất</option>
					<option>Giá tăng dần</option>
					<option>Giá giảm dần</option>
					<option>Nổi bật</option>
					<option>Tên A-Z</option>
				</select>
			</div>
		</div>
		<!-- End Product Filter & Sort Section -->

		<!-- Loading overlay cho shop -->
		<div id="shopLoading" style="display:none;position:fixed;z-index:20000;top:0;left:0;width:100vw;height:100vh;background:rgba(255,255,255,0.9);backdrop-filter:blur(3px);align-items:center;justify-content:center;">
		  <div style="display:flex;flex-direction:column;align-items:center;text-align:center;">
		    <div class="spinner-border text-info" style="width:3rem;height:3rem;" role="status"></div>
		    <div style="margin-top:16px;font-weight:600;color:#3b5d50;font-size:1.1rem;">Đang tải sản phẩm...</div>
		    <div style="margin-top:8px;color:#6c757d;font-size:0.9rem;">Vui lòng chờ trong giây lát</div>
		  </div>
		</div>

		<div class="untree_co-section product-section before-footer-section">
		    <div class="container">
		      	<div class="row">

		      		<!-- Sản phẩm sẽ được render động bằng JS -->

		      	</div>
		    </div>
		</div>

		<!-- Start Load More Section -->
		<div class="container mt-2 mb-4 text-center">
			<button class="btn btn-secondary px-5 py-3" style="font-size: 1.1rem; border-radius: 30px; box-shadow: 0 2px 16px rgba(59,93,80,0.08);">Xem thêm sản phẩm</button>
		</div>
		<!-- End Load More Section -->

		<!-- Start CTA Section -->
		<div class="container my-5">
			<div class="row justify-content-center">
				<div class="col-lg-8 text-center">
					<h3 class="mb-4">Bạn cần đặt làm riêng 1 sản phẩm mang dấu ấn cá nhân?</h3>
					<p>Liên hệ với chúng tôi để cùng kể câu chuyện của bạn.</p>
					<a href="contact.html" class="btn btn-secondary">Liên hệ ngay</a>
				</div>
			</div>
		</div>
		<!-- End CTA Section -->

		<!-- Nút nổi Call & Zalo -->
		<style>
.fab-contact {
  position: fixed;
  right: 24px;
  bottom: 24px;
  z-index: 9999;
  display: flex;
  flex-direction: column;
  gap: 16px;
}
.fab-contact-btn {
  width: 56px;
  height: 56px;
  border-radius: 50%;
  background: #3b5d50;
  color: #fff;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 4px 16px rgba(59,93,80,0.18);
  font-size: 28px;
  border: none;
  outline: none;
  cursor: pointer;
  transition: background 0.2s;
  animation: shakeFab 0.5s cubic-bezier(.36,.07,.19,.97) infinite;
  animation-iteration-count: infinite;
  animation-play-state: paused;
}
.fab-contact-btn.zalo-btn {
  background: #008fe5;
  padding: 0;
}
.fab-contact-btn.zalo-btn img {
  width: 32px;
  height: 32px;
}
@keyframes shakeFab {
  0% { transform: translateX(0); }
  10%, 30%, 50%, 70%, 90% { transform: translateX(-6px); }
  20%, 40%, 60%, 80% { transform: translateX(6px); }
  100% { transform: translateX(0); }
}
</style>
<div class="fab-contact">
  <a href="tel:0373566167" class="fab-contact-btn" id="callFab" title="Gọi điện"><span class="fa fa-phone"></span></a>
  <a href="https://zalo.me/0373566167" class="fab-contact-btn zalo-btn" id="zaloFab" title="Zalo" target="_blank"><img src="images/Icon_of_Zalo.png" alt="Zalo"></a>
</div>
<script>
function loopShakeFab(btnId) {
  var btn = document.getElementById(btnId);
  function shake() {
    btn.style.animationPlayState = 'running';
    setTimeout(function() {
      btn.style.animationPlayState = 'paused';
      setTimeout(shake, 2000);
    }, 500);
  }
  shake();
}
loopShakeFab('callFab');
loopShakeFab('zaloFab');
</script>

		<!-- Start Footer Section -->
		<footer class="footer-section">
			<div class="container relative">

				<div class="sofa-img">
					<img src="images/sofa.png" alt="Image" class="img-fluid">
				</div>

				<div class="row">
					<div class="col-lg-8">
						<div class="subscription-form">
							<h3 class="d-flex align-items-center"><span class="me-1"><img src="images/envelope-outline.svg" alt="Image" class="img-fluid"></span><span>Đăng ký nhận tin</span></h3>

							<form action="#" class="row g-3">
								<div class="col-auto">
									<input type="text" class="form-control" placeholder="Nhập tên của bạn">
								</div>
								<div class="col-auto">
									<input type="text" class="form-control" placeholder="Nhập số điện thoại của bạn">
								</div>
								<div class="col-auto">
									<button class="btn btn-primary">
										<span class="fa fa-paper-plane"></span>
									</button>
								</div>
							</form>

						</div>
					</div>
				</div>

				<div class="row g-5 mb-5">
					<div class="col-lg-4">
						<div class="mb-4 footer-logo-wrap"><a href="#" class="footer-logo">moctaisinh<span>.</span>vn</a></div>
						<p class="mb-4">Cảm hứng từ Cúc Phương – nơi thiên nhiên hồi sinh và lan tỏa. Website được đồng hành & thiết kế bởi Thanh Độ, người kể chuyện của những vật liệu cũ.</p>

						<ul class="list-unstyled custom-social">
							<li><a href="tel:0373566167" title="Gọi điện"><span class="fa fa-phone"></span></a></li>
							<li><a href="https://zalo.me/0373566167" target="_blank" title="Zalo"><span class="fa fa-comment-dots"></span></a></li>
							<li><a href="https://www.tiktok.com/@taisinh.vn" target="_blank" title="TikTok"><span class="fa fa-brands fa-tiktok"></span></a></li>
						</ul>
					</div>

					<div class="col-lg-8">
						<div class="row links-wrap">
							<div class="col-6 col-sm-6 col-md-3">
								<ul class="list-unstyled">
									<li><a href="about.html">Về Tái Sinh</a></li>
									<li><a href="services.html">Dịch vụ thủ công</a></li>
									<li><a href="blog.html">Câu chuyện cảm hứng</a></li>
									<li><a href="contact.html">Kết nối & Hợp tác</a></li>
								</ul>
							</div>

							<div class="col-6 col-sm-6 col-md-3">
								<ul class="list-unstyled">
									<li><a href="#">Hỗ trợ khách hàng</a></li>
									<li><a href="#">Kiến thức tái chế</a></li>
									<li><a href="#">Tư vấn trực tuyến</a></li>
								</ul>
							</div>

							<div class="col-6 col-sm-6 col-md-3">
								<ul class="list-unstyled">
									<li><a href="#">Tuyển dụng</a></li>
									<li><a href="#">Đội ngũ nghệ nhân</a></li>
									<li><a href="#">Lãnh đạo & Sứ mệnh</a></li>
									<li><a href="#">Chính sách bảo mật</a></li>
								</ul>
							</div>

							<div class="col-6 col-sm-6 col-md-3">
								<ul class="list-unstyled">
									<li><a href="#">Ngọn gió đầu mùa</a></li>
									<li><a href="#">Ký ức nhà kho cũ</a></li>
									<li><a href="#">Dấu lặng bên vách núi</a></li>
								</ul>
							</div>
						</div>
					</div>

				</div>

				<div class="border-top copyright">
					<div class="row pt-4">
						<div class="col-lg-6">
							<p class="mb-2 text-center text-lg-start">&copy; 2025 moctaisinh.vn. Cảm hứng từ Cúc Phương. Thiết kế & đồng hành bởi Thanh Độ.<br><span style="font-weight:600; color:#3b5d50;">Từ gốc – đến lá – từ tim</span><br><span style="color:#3b5d50;">Cam kết: Trích lợi nhuận trồng cây xanh, lan tỏa yêu thương, gieo mầm xanh mới.</span></p>
						</div>

						<div class="col-lg-6 text-center text-lg-end">
							<ul class="list-unstyled d-inline-flex ms-auto">
								<li class="me-4"><a href="#">Terms &amp; Conditions</a></li>
								<li><a href="#">Privacy Policy</a></li>
							</ul>
						</div>

					</div>
				</div>

			</div>
		</footer>
		<!-- End Footer Section -->	


			<script src="js/bootstrap.bundle.min.js"></script>
	<script src="js/tiny-slider.js"></script>
	<script src="js/custom.js"></script>
		<script>
const API_BASE = 'http://localhost:8080';
let allProducts = [];
let currentIndex = 0;
const pageSize = 8;
const productSection = document.querySelector('.product-section .row');
const loadMoreBtn = document.querySelector('.container.mt-2.mb-4.text-center button');
function showShopLoading(show=true) {
  document.getElementById('shopLoading').style.display = show ? 'flex' : 'none';
}
function formatVND(number) {
  if (!number) return '';
  return Number(number).toLocaleString('vi-VN') + '₫';
}
function truncateText(text, maxChars=60) {
  if (text.length <= maxChars) return text;
  return text.slice(0, maxChars-3) + '...';
}
function renderProducts() {
  // Xoá sản phẩm cũ
  productSection.innerHTML = '';
  // Render sản phẩm hiện tại
  for (let i = 0; i < currentIndex; i++) {
    const p = allProducts[i];
    if (!p) continue;
    const col = document.createElement('div');
    col.className = 'col-12 col-md-4 col-lg-3 mb-5';
    col.innerHTML = `
      <div class="product-item" data-product-id="${p.id}">
        <img src="${p.image}" class="img-fluid product-thumbnail">
        <h3 class="product-title clamp-2">${p.name}</h3>
        <strong class="product-price" style="display: block; margin-top: 8px; margin-bottom: 8px;">${formatVND(p.price)}</strong>
        <div class="product-desc-hover">${truncateText(p.description, 60)}</div>
        <span class="icon-cross"><img src="images/cross.svg" class="img-fluid"></span>
      </div>
    `;
    
    // Thêm event listener cho sản phẩm
    const productItem = col.querySelector('.product-item');
    productItem.addEventListener('click', function() {
      handleProductClick(p);
    });
    
    productSection.appendChild(col);
  }
  // Ẩn nút nếu hết sản phẩm
  if (currentIndex >= allProducts.length) {
    loadMoreBtn.style.display = 'none';
  } else {
    loadMoreBtn.style.display = '';
  }
}
async function fetchProducts() {
  showShopLoading(true);
  try {
    const res = await fetch(`${API_BASE}/api/products`);
    allProducts = await res.json();
    currentIndex = Math.min(pageSize, allProducts.length);
    renderProducts();
  } catch (e) {
    productSection.innerHTML = '<div class="text-danger">Không thể tải sản phẩm. Vui lòng thử lại sau.</div>';
    loadMoreBtn.style.display = 'none';
  }
  showShopLoading(false);
}
loadMoreBtn.addEventListener('click', function() {
  showShopLoading(true);
  setTimeout(() => { // Giả lập loading, có thể bỏ nếu muốn
    currentIndex = Math.min(currentIndex + pageSize, allProducts.length);
    renderProducts();
    showShopLoading(false);
  }, 600);
});
// CSS clamp 2 dòng cho tiêu đề
const style = document.createElement('style');
style.innerHTML = `.clamp-2 { display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; text-overflow: ellipsis; min-height: 2.6em; }`;
document.head.appendChild(style);
// Thêm CSS bo tròn ảnh sản phẩm và cố định chiều cao
const style2 = document.createElement('style');
style2.innerHTML = `
.product-thumbnail { 
  border-radius: 18px !important; 
  width: 100% !important;
  height: 280px !important;
  object-fit: cover !important;
}
.product-item {
  height: 100% !important;
  display: flex !important;
  flex-direction: column !important;
}
.product-item .product-title {
  flex-grow: 1 !important;
  margin-bottom: 8px !important;
}
.product-item .product-price {
  margin-top: auto !important;
}
`;
document.head.appendChild(style2);
// Hàm xử lý click sản phẩm - fetch data trước khi chuyển trang
async function handleProductClick(product) {
  // Cập nhật loading message
  const loadingDiv = document.getElementById('shopLoading');
  const loadingText = loadingDiv.querySelector('div:nth-child(2)');
  loadingText.textContent = `Đang tải thông tin ${product.name}...`;
  
  // Hiển thị loading overlay
  showShopLoading(true);
  
  try {
    // Fetch thông tin chi tiết sản phẩm từ API
    const response = await fetch(`${API_BASE}/api/products`);
    const allProducts = await response.json();
    const productDetail = allProducts.find(p => p.id === product.id);
    
    if (!productDetail) {
      throw new Error('Không tìm thấy thông tin sản phẩm');
    }
    
    // Preload tất cả ảnh của sản phẩm
    const imageUrls = [];
    if (productDetail.image) imageUrls.push(productDetail.image);
    if (productDetail.images) {
      const additionalImages = productDetail.images.split(',').map(url => url.trim());
      imageUrls.push(...additionalImages);
    }
    
    // Preload tất cả ảnh
    const preloadPromises = imageUrls.map(url => {
      return new Promise((resolve) => {
        const img = new Image();
        img.onload = resolve;
        img.onerror = resolve; // Vẫn tiếp tục nếu ảnh lỗi
        img.src = url;
      });
    });
    
    // Đợi tất cả ảnh load xong (tối đa 3 giây)
    await Promise.race([
      Promise.all(preloadPromises),
      new Promise(resolve => setTimeout(resolve, 3000))
    ]);
    
    // Lưu thông tin sản phẩm vào sessionStorage để trang detail sử dụng
    sessionStorage.setItem('productDetail', JSON.stringify(productDetail));
    
    // Cập nhật loading message
    loadingText.textContent = 'Chuyển trang...';
    
    // Thêm hiệu ứng transition mượt
    document.body.style.opacity = '0.8';
    document.body.style.transition = 'opacity 0.3s ease';
    
    setTimeout(() => {
      // Chuyển trang với dữ liệu đã có sẵn
      window.location.href = `detail.html?id=${product.id}`;
    }, 300);
    
  } catch (error) {
    console.error('Error fetching product details:', error);
    // Vẫn chuyển trang nếu có lỗi, để trang detail tự load
    window.location.href = `detail.html?id=${product.id}`;
  }
}

// Thêm CSS cho loading state và cải thiện UX
const loadingStyle = document.createElement('style');
loadingStyle.innerHTML = `
  .product-item {
    cursor: pointer;
    transition: all 0.3s ease;
    position: relative;
    overflow: visible;
  }
  
  .product-item:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 25px rgba(59,93,80,0.15);
  }
  
  .product-item:active {
    transform: translateY(-2px);
  }
  
  .product-item.loading {
    pointer-events: none;
    opacity: 0.7;
  }
  
  .product-item.loading::after {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 20px;
    height: 20px;
    margin: -10px 0 0 -10px;
    border: 2px solid #3b5d50;
    border-top: 2px solid transparent;
    border-radius: 50%;
    animation: spin 1s linear infinite;
  }
  
  @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }
  
  /* Cải thiện loading overlay */
  #shopLoading {
    animation: fadeIn 0.3s ease;
  }
  
  @keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
  }
  
    /* Đảm bảo ảnh và nội dung luôn hiển thị đầy đủ */
  .product-item img,
  .product-item .product-thumbnail {
    position: relative !important;
    z-index: 10 !important;
    pointer-events: none;
  }
  
  .product-item .product-title,
  .product-item .product-price,
  .product-item .product-desc-hover {
    position: relative !important;
    z-index: 10 !important;
  }
  
  /* Đảm bảo icon cross giống trang index */
  .product-item .icon-cross {
    position: absolute !important;
    width: 35px !important;
    height: 35px !important;
    display: inline-block !important;
    background: #2f2f2f !important;
    bottom: 15px !important;
    left: 50% !important;
    transform: translateX(-50%) !important;
    margin-bottom: -17.5px !important;
    border-radius: 50% !important;
    opacity: 0 !important;
    visibility: hidden !important;
    transition: .3s all ease !important;
    z-index: 20 !important;
  }
  
  .product-item .icon-cross img {
    position: absolute !important;
    left: 50% !important;
    top: 50% !important;
    transform: translate(-50%, -50%) !important;
  }
  
  /* Hiển thị icon khi hover */
  .product-item:hover .icon-cross {
    bottom: 0 !important;
    opacity: 1 !important;
    visibility: visible !important;
  }
  
  /* Đảm bảo hover không che nội dung */
  .product-item:hover img,
  .product-item:hover .product-thumbnail,
  .product-item:hover .icon-cross {
    z-index: 20 !important;
  }
 
 `;
  document.head.appendChild(loadingStyle);

// Khởi động
fetchProducts();
</script>
	</body>

</html>
